const spiceID="4de69e374a8ed21cbddd47f2338cc0f479dc58daa2bbe11cd604ca488eca0ddf";var cssButtonId='pbButtonCSS';if(!document.getElementById(cssButtonId)){var head=document.getElementsByTagName('head')[0];var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href='/css/buttons.css';link.id=cssButtonId;link.media='all';head.appendChild(link)}
var cssModalId='pbModalCSS';if(!document.getElementById(cssModalId)){var head=document.getElementsByTagName('head')[0];var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href='/css/modal.css';link.id=cssModalId;link.media='all';head.appendChild(link)}
var qrId='pbQR';if(!document.getElementById(qrId)){var head=document.getElementsByTagName('head')[0];var script=document.createElement('script');script.src='/js/qrjs2.js';script.id=qrId;head.appendChild(script)}(function(){this.Modal=function(){this.closeButton=null;this.modal=null;this.overlay=null;this.transitionEnd=transitionSelect();var defaults={autoOpen:!1,className:'fade-and-drop',content:'',maxWidth:270,minWidth:264,overlay:!0};if(arguments[0]&&typeof arguments[0]==='object'){this.options=extendDefaults(defaults,arguments[0])}
if(this.options.autoOpen===!0)this.open()};Modal.prototype.close=function(){if(window.payButtonModalOpen){var _=this;this.modal.className=this.modal.className.replace(' spicebutton-open','');this.overlay.className=this.overlay.className.replace(' spicebutton-open','');this.modal.addEventListener(this.transitionEnd,function(){_.modal.parentNode.removeChild(_.modal)});this.overlay.addEventListener(this.transitionEnd,function(){if(_.overlay.parentNode)_.overlay.parentNode.removeChild(_.overlay)});window.payButtonModalOpen=!1;delete window.payButtonParent}};Modal.prototype.open=function(){if(!window.payButtonModalOpen){buildOut.call(this);initializeEvents.call(this);window.getComputedStyle(this.modal).height;this.modal.className=this.modal.className+(this.modal.offsetHeight>window.innerHeight?' spicebutton-open spicebutton-anchored':' spicebutton-open');this.overlay.className=this.overlay.className+' spicebutton-open';window.payButtonModalOpen=!0}};function buildOut(){var content,contentHolder,docFrag;if(typeof this.options.content==='string'){content=this.options.content}else{content=this.options.content.innerHTML}
docFrag=document.createDocumentFragment();this.modal=document.createElement('div');this.modal.className='spicebutton-modal '+this.options.className;if(this.options.overlay===!0){this.overlay=document.createElement('div');this.overlay.className='spicebutton-overlay '+this.options.className;docFrag.appendChild(this.overlay)}
contentHolder=document.createElement('div');contentHolder.className='spicebutton-content';contentHolder.id='modal-content';contentHolder.innerHTML=content;this.modal.appendChild(contentHolder);docFrag.appendChild(this.modal);document.body.appendChild(docFrag)}
function extendDefaults(source,properties){var property;for(property in properties){if(properties.hasOwnProperty(property)){source[property]=properties[property]}}
return source}
function initializeEvents(){if(this.closeButton){this.closeButton.addEventListener('click',this.close.bind(this))}
if(this.overlay){this.overlay.addEventListener('click',this.close.bind(this))}
document.getElementById('bch-open').addEventListener('click',function(){this.innerHTML='<span>Opening SLP Wallet</span>'})}
function transitionSelect(){var el=document.createElement('div');if(el.style.WebkitTransition)return'webkitTransitionEnd';if(el.style.OTransition)return'oTransitionEnd';return'transitionend'}})();function copyBCHURI(address){var inp=document.createElement('input');inp.value=address;window.payButtonParent.appendChild(inp);inp.select();document.execCommand('copy',!1,null);inp.remove();document.getElementById('copyDiv').innerHTML='<span>Address Copied!</span>'}
function playAudio(){var successAudio=new Audio('/audio/pbding.mp3');successAudio.volume=0.02;successAudio.play()}
function getRandomSat(){return(Math.random()*(0.00000123-0.0000001)+0.0000001).toFixed(8)}
var txListen;function startListenForTX(pbAttr){pbAttr.timeStamp=Math.floor(Date.now()/1000);txListen=listenForTX(pbAttr)}
function txDialogue(pbAttr){playAudio();if(!pbAttr.successMsg){pbAttr.successMsg='Transaction Successful!'}
var successDisplay=document.getElementById('modal-content');successDisplay.innerHTML='<div>'+'<div>'+'<div class="txdialoguediv">'+'<div><span>'+pbAttr.successMsg+'</span></div>'+'</div>'+'<div class="txdialoguediv">'+'<div><span>View: </span><a href="https://explorer.bitcoin.com/bch/tx/'+pbAttr.txid+'" target="_blank" style="color: orangeRed; text-decoration: none;">Transaction</a></div>'+'</div>'+'</div>'+'</div>';console.log('Confirmed. Transaction ID:',pbAttr.txid);var paywallFieldExists=document.getElementsByClassName(pbAttr.paywallField);if(paywallFieldExists){for(var i=0;i<paywallFieldExists.length;i++){var paywallFields=paywallFieldExists[i];paywallFields.style.display='block'}}
if(pbAttr.successCallback&&window[pbAttr.successCallback]){window[pbAttr.successCallback](pbAttr.txid)}}
function listenForTX(pbAttr){var address=pbAttr.toAddress;var query={"v":3,"q":{"find":{"slp.detail.tokenIdHex":spiceID,"out.e.a":address}}}
var txRequest=new EventSource('https://slpsocket.fountainhead.cash/s/'+btoa(JSON.stringify(query)))
txRequest.onmessage=function(event){console.log('listening for transaction..');var txData=JSON.parse(event.data);if(txData.type=='mempool'){for(var i=0;i<txData.data[0].slp.detail.outputs.length;i++){if(txData.data[0].slp.detail.outputs[i].address==address){var spiceReceived=txData.data[0].slp.detail.outputs[i].amount;var txid=txData.data[0].tx.h;if(pbAttr.anyAmount){if(spiceReceived>0){successMsg="Recieved "+spiceReceived;txRequest.close();pbAttr.txid=txid;txDialogue(pbAttr);return}}
if(spiceReceived==pbAttr.bchAmount){txRequest.close();pbAttr.txid=txid;txDialogue(pbAttr);return}}}}}}
function sendToBadger(toAddress,bchAmount,successMsg,paywallField,successCallback){if(typeof web4bch!=='undefined'){web4bch=new Web4Bch(web4bch.currentProvider);if(!web4bch.bch.defaultAccount){document.getElementById('badger-open').innerHTML='<span>Please Unlock Badger Wallet</span>';alert('Please unlock Badger Wallet before continuing.')}else{document.getElementById('badger-open').innerHTML='<span>Opening Badger Wallet</span>';var txParams={to:toAddress,from:web4bch.bch.defaultAccount,value:bchAmount,sendTokenData:{tokenId:spiceID,tokenProtocol:'slp'}};web4bch.bch.sendTransaction(txParams,(err,res)=>{if(err){document.getElementById('badger-open').innerHTML='<span>Send With Badger Wallet</span>'}else{var pbAttr={txid:res,successMsg:successMsg,paywallField:paywallField,successCallback:successCallback};txDialogue(pbAttr)}})}}else{document.getElementById('badger-open').innerHTML='<span>Badger Wallet Not Found</span>';window.open('https://badger.bitcoin.com');alert('To use Badger Wallet for this transaction, Please visit:\n\nhttps://badger.bitcoin.com for installation instructions.')}}
function openModal(pbAttr){if(pbAttr.anyAmount){pbAttr.amountMessage='Send any amount of Spice';pbAttr.URI=pbAttr.toAddress}else{pbAttr.URI=pbAttr.toAddress+'?amount='+pbAttr.bchAmount}
startListenForTX(pbAttr);var qrParams={ecclevel:'Q',fillcolor:'#FFFFFF',textcolor:'#000000',margin:'0.5',modulesize:12};if(document.implementation.hasFeature('http://www.w3.org/2000/svg','1.1')){genQR=QRCode.generateSVG(pbAttr.URI,qrParams);var XMLS=new XMLSerializer();genQR=XMLS.serializeToString(genQR);genQR='data:image/svg+xml;base64,'+window.btoa(unescape(encodeURIComponent(genQR)));qrImage=genQR}else{genQR=QRCode.generatePNG(pbAttr.URI,qrParams);qrImage=genQR}
var pbContent='<div>'+'<div>'+'<div>'+'<div class="qrparent" onclick=copyBCHURI(\''+pbAttr.URI+"')>"+'<img class="qrcode" src="'+qrImage+'" />'+'<img class="qricon" src="./images/bitcoincash_bare_logo.png" />'+'<div id="copyDiv" class="qrctc">Click to Copy</div>'+'</div>'+'</div>'+'<div class="dialoguediv">'+'<div><span>'+pbAttr.amountMessage+'</span></div> '+'</div>'+'<div>'+'<div><button id="bch-open" class="spice-button pb-modal-button" onclick="location.href=\''+pbAttr.URI+'-'+spiceID+'\'" type="button"><span>Send with SLP Wallet</span></button></div>'+'</div>'+'<div>'+'<div><button id="badger-open" class = "spice-button pb-modal-button" onclick="sendToBadger(\''+pbAttr.toAddress+"', '"+pbAttr.bchAmount+"', '"+pbAttr.successMsg+"', '"+pbAttr.paywallField+"', '"+pbAttr.successCallback+'\')" type="button"><span>Send with Badger Wallet</span></button></div> '+'</div>'+'<div class="poweredbydiv">'+'<div><span><a href="https://spicebutton.com" target="_blank" style="color: orangeRed; text-decoration: none;">Powered by spicebutton.com</a></span></div>'+'</div>'+'</div>'+'</div>';if(pbAttr.anyAmount){pbContent='<div>'+'<div>'+'<div>'+'<div class="qrparent" onclick=copyBCHURI(\''+pbAttr.URI+"')>"+'<img class="qrcode" src="'+qrImage+'" />'+'<img class="qricon" src="./images/bitcoincash_bare_logo.png" />'+'<div id="copyDiv" class="qrctc">Click to Copy</div>'+'</div>'+'</div>'+'<div class="dialoguediv">'+'<div><span>'+pbAttr.amountMessage+'</span></div> '+'</div>'+'<div>'+'<div><button id="bch-open" class="spice-button pb-modal-button" onclick="location.href=\''+pbAttr.URI+'-'+spiceID+'\'" type="button"><span>Send with SLP Wallet</span></button></div>'+'</div>'+'<div class="poweredbydiv">'+'<div><span><a href="https://spicebutton.com" target="_blank" style="color: orangeRed; text-decoration: none;">Powered by spicebutton.com</a></span></div>'+'</div>'+'</div>'+'</div>'}
var pbModal=new Modal({content:pbContent});pbModal.open()}
function getBCHPrice(pbAttr){var fiatRequest=new XMLHttpRequest();fiatRequest.open('GET','https://api.coingecko.com/api/v3/simple/price?ids=spice&vs_currencies='+pbAttr.amountType,!0);fiatRequest.onload=function(){if(fiatRequest.readyState==4&&fiatRequest.status==200){var fiatData=JSON.parse(fiatRequest.responseText);if(fiatData!=''){var satAmount=(1/fiatData.spice[pbAttr.amountType.toLowerCase()])*pbAttr.buttonAmount;pbAttr.satAmount=satAmount.toFixed(8);pbAttr.randSat=0;var bchAmount=Number(pbAttr.satAmount);pbAttr.bchAmount=bchAmount.toFixed(8);pbAttr.amountMessage=pbAttr.buttonAmount+' '+pbAttr.amountType+' = '+pbAttr.bchAmount+' SPICE';openModal(pbAttr)}else{console.log('Error Price Not Found')}}else{console.log('Found Server But There Is An Error')}};fiatRequest.onerror=function(){console.log('Could Not Connect To Server')};fiatRequest.send();fiatRequest.onerror=function(){console.log('Could Not Connect To Server')};fiatRequest.send()};function mouseEnter(){var buttonText2=this.getAttribute('button-text-2')||'';buttonText2=buttonText2.trim();if(!buttonText2){var showAmount=this.getAttribute('amount')||'';showAmount=Number(showAmount.trim());var showType=this.getAttribute('amount-type')||'';showType=showType.trim().toUpperCase();buttonText2=showAmount+' '+showType;if(!showAmount||!showType){buttonText2='Click to send Spice'}}
this.innerHTML='<span>&nbsp</span>';var x=this;setTimeout(function(){x.innerHTML='<span>'+buttonText2+'</span>'},200);if(!('ontouchend' in window))
this.addEventListener('mouseleave',buttonDefaultText,!1);if('ontouchend' in window)
this.addEventListener('touchend',buttonDefaultText,!1)}
function buttonDefaultText(){var buttonText=this.getAttribute('button-text')||'';buttonText=buttonText.trim();if(!buttonText){var showAmount=this.getAttribute('amount')||'';showAmount=Number(showAmount.trim());var showType=this.getAttribute('amount-type')||'';showType=showType.trim().toUpperCase();buttonText='Send Spice';if(!showAmount||!showType){buttonText='Send Spice'}}
this.innerHTML='<span>&nbsp</span>';var x=this;setTimeout(function(){x.innerHTML='<span>'+buttonText+'</span>'},200)}
function renderButtons(config){var payButton=document.getElementsByClassName('spice-button');for(var i=0;i<payButton.length;i++){var payButtons=payButton[i];if(config.onDemand===!1&&payButtons.classList.contains('pbtnjs')){continue}
let defaultText=buttonDefaultText.bind(payButtons);defaultText();if(!('ontouchstart' in window))
payButtons.addEventListener('mouseenter',mouseEnter,!1);if('ontouchstart' in window)
payButtons.addEventListener('touchstart',mouseEnter,!1);payButtons.setAttribute('type','button');payButtons.addEventListener('click',function(pbEvent){window.payButtonParent=pbEvent.target.parentNode;var buttonAmount=this.getAttribute('amount')||'';buttonAmount=Number(buttonAmount.trim());var amountType=this.getAttribute('amount-type')||'';amountType=amountType.trim().toUpperCase();var toAddress=this.getAttribute('address')||'';toAddress=toAddress.trim();var successMsg=this.getAttribute('success-msg')||'';successMsg=successMsg.trim();var paywallField=this.getAttribute('paywall-field')||'';paywallField=paywallField.trim();var successCallback=this.getAttribute('success-callback')||'';successCallback=successCallback.trim();var bchAmount;var amountMessage;var anyAmount;var pbAttr={buttonAmount:buttonAmount,amountType:amountType,toAddress:toAddress,successMsg:successMsg,paywallField:paywallField,successCallback:successCallback,anyAmount:!1};if(!toAddress){alert('Spice Button Error:\n\nBelow are the minimum button requirements\n\n1. address (Bitcoin Cash SLP address)');return}
if(buttonAmount||amountType){if(!buttonAmount||!amountType){alert('Spice Button Error:\n\nFor specific Spice Button amounts, BOTH of the following MUST be set:\n\n1. amount (Must be a number)\n2. amount-type (Can be BCH, Satoshi, USD, AUD etc)\n\nTo allow "Any" amount, BOTH must be blank.');return}}else{pbAttr.anyAmount=!0}
if(!buttonAmount&&!amountType){pbAttr.anyAmount=!0;pbAttr.bchAmount=''}
if(pbAttr.anyAmount){openModal(pbAttr)}else{if(amountType=='SPICE'||amountType=='SATOSHI'){var satAmount=buttonAmount;if(amountType=='SATOSHI'){satAmount=satAmount/100000000}
pbAttr.satAmount=satAmount.toFixed(8);pbAttr.randSat=0;bchAmount=Number(pbAttr.satAmount)+Number(pbAttr.randSat);pbAttr.bchAmount=bchAmount;pbAttr.amountMessage='Amount = '+pbAttr.bchAmount+' SPICE';openModal(pbAttr)}else{getBCHPrice(pbAttr)}}})}}
document.addEventListener('DOMContentLoaded',function(){renderButtons({onDemand:!1})});var Spicebutton={render:function(id,config){var elem=document.getElementById(id);var newBtn=document.createElement('button');newBtn.setAttribute('id',id);if(config.style){newBtn.setAttribute('style:',config.style)}
if(config.class){newBtn.setAttribute('class','spice-button '+config.style+' pbtnjs')}else{newBtn.setAttribute('class','spice-button pbtnjs')}
if(config.button_text){newBtn.setAttribute('button-text',config.button_text)}
if(config.button_text_2){newBtn.setAttribute('button-text-2',config.button_text_2)}
if(config.success_msg){newBtn.setAttribute('success-msg',config.success_msg)}
if(config.address){newBtn.setAttribute('address',config.address)}
if(config.amount){newBtn.setAttribute('amount',config.amount)}
if(config.amount_type){newBtn.setAttribute('amount-type',config.amount_type)}
else if(config.amount){newBtn.setAttribute('amount-type','bch')}
if(config.paywall_field){newBtn.setAttribute('paywall-field',config.paywall_field)}
if(config.success_callback){newBtn.setAttribute('success-callback',config.success_callback)}
elem.parentNode.replaceChild(newBtn,elem);renderButtons({onDemand:!0})}}